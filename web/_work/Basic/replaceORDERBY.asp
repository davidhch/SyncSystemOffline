<%

strSQL = "SELECT MIN(DISTINCT[View_ReportSummary].[ClickedDateTime]) AS [ClickedDateTime], [View_ReportSummary].[EmailID], [View_ReportSummary].[OpenedDateTime], [View_ReportSummary].[SuccessfullySent], [View_ReportSummary].[Bounced], [View_ReportSummary].[BouncedType], [View_ReportSummary].[Opened], [View_ReportSummary].[EmailAddress], [View_ReportSummary].[CustomerID], [View_ReportSummary].[Clicked], [View_ReportSummary].[NoTimesOpened], [View_ReportSummary].[UnSubscribed] , EmailAddresses.Title AS Subscriber_Title, EmailAddresses.FirstName AS Subscriber_First_Name, EmailAddresses.LastName AS Subscriber_Last_Name, EmailAddresses.EmailList, EmailAddresses.EmailType, EmailAddresses.MobilePhone, EmailAddresses.CompanyName, EmailAddresses.DateAdded, EmailAddresses.Source, EmailAddresses.Confirmed, EmailAddresses.ConfirmDate, EmailAddresses.[Use],EmailAddresses.Unsubscribed,EmailAddresses.UnsubscribeDate,Addresses.FirstName, Addresses.LastName, Addresses.Title, Addresses.JobTitle, Addresses.Company, Addresses.Address1, Addresses.Address2, Addresses.Address3, Addresses.City, Addresses.County, Addresses.Postcode, Addresses.Country, Addresses.TelNo, Addresses.FaxNo, View_CUSTOMFIELDS.CustomFieldName AS 'Custom_Field_Name', View_CUSTOMFIELDS.CustomFieldData AS 'Custom_Field_Data' FROM [View_ReportSummary] LEFT OUTER JOIN EmailAddresses ON View_ReportSummary.EmailID = EmailAddresses.ID LEFT OUTER JOIN Addresses ON View_ReportSummary.EmailID = Addresses.EmailID LEFT OUTER JOIN View_CUSTOMFIELDS ON View_ReportSummary.EmailID = View_CUSTOMFIELDS.EmailAddressID WHERE [View_ReportSummary].[CampaignID]=145128  AND [View_ReportSummary].[EmailAddress] LIKE '%'  AND [View_ReportSummary].[SuccessfullySent]=1   AND (View_CUSTOMFIELDS.CustomerID = 212 OR View_CUSTOMFIELDS.CustomerID IS NULL) GROUP BY View_CUSTOMFIELDS.CustomFieldData, View_CUSTOMFIELDS.CustomFieldName, Addresses.FirstName, Addresses.LastName, Addresses.Title, Addresses.JobTitle, Addresses.Company, Addresses.Address1, Addresses.Address2, Addresses.Address3, Addresses.City, Addresses.County, Addresses.Postcode, Addresses.Country, Addresses.TelNo, Addresses.FaxNo, EmailAddresses.Title, EmailAddresses.FirstName, EmailAddresses.LastName, EmailAddresses.EmailType, EmailAddresses.MobilePhone, EmailAddresses.CompanyName, EmailAddresses.DateAdded, EmailAddresses.Source, EmailAddresses.ConfirmDate, EmailAddresses.EmailList, EmailAddresses.Confirmed, EmailAddresses.[Use],EmailAddresses.Unsubscribed,EmailAddresses.UnsubscribeDate,[View_ReportSummary].[EmailID], [View_ReportSummary].[SuccessfullySent], [View_ReportSummary].[Bounced], [View_ReportSummary].[Opened], [View_ReportSummary].[EmailAddress], [View_ReportSummary].[CustomerID], [View_ReportSummary].[Clicked], [View_ReportSummary].[NoTimesOpened], [View_ReportSummary].[BouncedType], [View_ReportSummary].[UnSubscribed], [View_ReportSummary].[OpenedDateTime] ORDER BY [View_ReportSummary].[EmailAddress]"


strSQL = right(strSQL,(len(strSQL) - instr(strSQL,"ORDER BY")+1)) 

response.write strSQL 
%>